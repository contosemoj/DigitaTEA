<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <title>Sincronizador de Legendas - DigitaTEA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.youtube.com/iframe_api"></script>
</head>

<body class="bg-gray-100 p-8 flex flex-col h-screen overflow-hidden">
    <!-- Same content as before -->
    <div class="flex gap-6 h-full">
        <div class="flex-1 flex flex-col">
            <div class="bg-black rounded-xl overflow-hidden shadow-lg aspect-video">
                <div id="player"></div>
            </div>
            <div class="mt-4 bg-white p-6 rounded-xl shadow-md flex flex-col items-center gap-4">
                <div class="text-center">
                    <h2 class="text-xl font-bold text-gray-700">Controles</h2>
                    <p class="text-sm text-gray-500">Pressione <span
                            class="font-bold bg-gray-200 px-2 rounded">ESPA√áO</span> para marcar o in√≠cio da frase
                        atual.</p>
                </div>
                <button id="btnMark" onclick="markTime()" disabled
                    class="w-full py-4 bg-blue-500 hover:bg-blue-600 text-white text-2xl font-bold rounded-xl shadow-lg transition-transform active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed">MARCAR
                    IN√çCIO (Espa√ßo)</button>
                <div class="flex gap-2 w-full">
                    <button onclick="rewind(5)"
                        class="flex-1 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg text-gray-700 font-bold">‚è™
                        -5s</button>
                </div>
            </div>
        </div>
        <div class="w-1/3 flex flex-col bg-white rounded-xl shadow-md overflow-hidden">
            <div class="p-4 bg-blue-600 text-white font-bold flex justify-between items-center">
                <span>Legendas</span>
                <span id="progress">0/33</span>
            </div>
            <div id="list" class="flex-1 overflow-y-auto p-2 space-y-2"></div>
            <div class="p-4 border-t bg-gray-50">
                <button onclick="exportJSON()"
                    class="w-full py-3 bg-green-500 hover:bg-green-600 text-white font-bold rounded-lg shadow-sm">üìã
                    Copiar JSON</button>
            </div>
        </div>
    </div>
    <script>
        const videoId = "ZHKRxjwKnXM";
        let subtitles = [
            { text: "VENTO VENTANIA ME LEVE PARA AS BORDAS DO C√âU" },
            { text: "EU VOU PUXAR AS BARBAS DE DEUS" },
            { text: "VENTO VENTANIA ME LEVE PRA ONDE NASCE A CHUVA" },
            { text: "PRA L√Å DE ONDE O VENTO FAZ A CURVA" },
            { text: "ME DEIXE CAVALGAR NOS SEUS DESATINOS" },
            { text: "NAS REVOADAS REDEMOINHOS" },
            { text: "VENTO VENTANIA ME LEVE SEM DESTINO" },
            { text: "QUERO JUNTAR ME A VOC√ä" },
            { text: "E CARREGAR OS BAL√ïES PRO MAR" },
            { text: "QUERO ENROLAR AS PIPAS NOS FIOS" },
            { text: "MANDAR MEUS BEIJOS PELO AR" },
            { text: "VENTO VENTANIA ME LEVE PRA QUALQUER LUGAR" },
            { text: "ME LEVE PARA QUALQUER CANTO DO MUNDO" },
            { text: "√ÅSIA EUROPA AM√âRICA" },
            { text: "VENTO VENTANIA ME LEVE PARA AS BORDAS DO C√âU" },
            { text: "EU VOU PUXAR AS BARBAS DE DEUS" },
            { text: "ME LEVE PARA ONDE NASCE A CHUVA" },
            { text: "VENTO VENTANIA ME LEVE PARA OS QUATRO CANTOS DO MUNDO" },
            { text: "ME LEVE PRA QUALQUER LUGAR" },
            { text: "PRA L√Å DE ONDE O VENTO FAZ A CURVA" },
            { text: "ME DEIXE CAVALGAR NOS SEUS DESATINOS" },
            { text: "NAS REVOADAS REDEMOINHOS" },
            { text: "VENTO VENTANIA ME LEVE SEM DESTINO" },
            { text: "QUERO MOVER AS P√ÅS DOS MOINHOS" },
            { text: "E ABRANDAR O CALOR DO SOL" },
            { text: "QUERO EMARANHAR O CABELO DA MENINA" },
            { text: "MANDAR MEUS BEIJOS PELO AR" },
            { text: "VENTO VENTANIA AGORA QUE EU ESTOU SOLTO NA VIDA" },
            { text: "ME LEVE PRA QUALQUER LUGAR" },
            { text: "ME LEVE MAS N√ÉO ME FA√áA VOLTAR" },
            // Removed LE LE LE repetitions for simplicity or keep?
            { text: "L√ä L√ä L√ä L√ä" }, { text: "L√ä L√ä L√ä L√ä" }, { text: "L√ä L√ä L√ä L√ä L√ä L√ä L√ä L√ä" }
        ];
        let currentIndex = 0;
        let player;
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', { height: '100%', width: '100%', videoId: videoId, events: { 'onReady': onPlayerReady } });
        }
        function onPlayerReady(event) { document.getElementById('btnMark').disabled = false; renderList(); }
        function renderList() {
            const list = document.getElementById('list'); list.innerHTML = '';
            subtitles.forEach((sub, i) => {
                const el = document.createElement('div');
                el.className = `p-3 rounded-lg border-2 cursor-pointer transition-colors ${i === currentIndex ? 'border-blue-500 bg-blue-50' : 'border-gray-100 bg-white'}`;
                el.id = `line-${i}`;
                const timeInfo = sub.start !== undefined ? `<span class="bg-green-100 text-green-700 font-mono text-xs px-2 py-1 rounded ml-2">${sub.start.toFixed(1)}s</span>` : '';
                el.innerHTML = `<div class="flex justify-between items-center"><span class="font-bold text-gray-400 text-xs w-6">#${i + 1}</span><p class="flex-1 text-sm font-semibold text-gray-700">${sub.text}</p>${timeInfo}</div>`;
                el.onclick = () => { currentIndex = i; renderList(); };
                list.appendChild(el);
            });
            document.getElementById('progress').innerText = `${currentIndex + 1}/${subtitles.length}`;
            const el = document.getElementById(`line-${currentIndex}`);
            if (el) el.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        function markTime() {
            if (!player || !player.getCurrentTime) return;
            const time = player.getCurrentTime();
            subtitles[currentIndex].start = parseFloat(time.toFixed(1));
            // Auto calculate end time for next one roughly or current one
            if (currentIndex > 0 && subtitles[currentIndex - 1].start !== undefined) {
                subtitles[currentIndex - 1].end = subtitles[currentIndex].start; // Previous ends when current starts
            }
            subtitles[currentIndex].end = subtitles[currentIndex].start + 4; // Default
            currentIndex++;
            if (currentIndex >= subtitles.length) currentIndex = subtitles.length - 1;
            renderList();
        }
        function rewind(sec) { const t = player.getCurrentTime(); player.seekTo(Math.max(0, t - sec)); }
        function exportJSON() {
            // Fix last item end time
            if (subtitles.length > 0) subtitles[subtitles.length - 1].end = subtitles[subtitles.length - 1].start + 5;
            const final = subtitles.map(s => ({ text: s.text, start: s.start || 0, end: s.end || 0 }));
            navigator.clipboard.writeText(JSON.stringify(final, null, 2));
            alert("Copiado! Cole no chat.");
        }
        document.addEventListener('keydown', (e) => { if (e.code === 'Space') { e.preventDefault(); markTime(); } });
    </script>
</body>

</html>